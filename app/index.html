<!--
  https://www.w3schools.com/js/js_conventions.asp
-->

<html>
<head>
   <meta name='viewport' content = 'width = device-width, initial-scale = 1.0, user-scalable = no'/>
   <link href="https://fonts.googleapis.com/css?family=Lobster" rel="stylesheet">
   <script type="text/javascript" src="jquery-2.1.3.min.js"></script>
   <script type="text/javascript" src="introtoapps.min.js"></script>

   <script type="text/javascript">
   /* Namespacing
      Global Game Settings
   */
      var windowWidth = $(window).width(),
          windowHeight = $(window).height(),
          paused = false,
          debug = true;
          Burnout = {};

      function log(log) {
        if (debug == true) {
          console.info(log);
        }
      }

      Burnout.road = (function() {
        /* road Object state
           1. ROAD_SPEED: at which the road is animated.
              (Larger values indicate lower speed.)
        */
        var roadWidth = windowWidth,
            ROAD_IMAGE01 = '.road01',
            ROAD_IMAGE02 = '.road02',
            ROAD_SPEED = 100;

        function initializeRoad() {
          $(ROAD_IMAGE01).css("transform", "scale("+scaleFactor($(ROAD_IMAGE01).width())+")");
          $(ROAD_IMAGE02).css("transform", "scale("+scaleFactor($(ROAD_IMAGE01).width())+")");
        }

        function animateRoad(){
          $(ROAD_IMAGE02).hide(ROAD_SPEED)
                         .show(ROAD_SPEED);
        }

        return {
          initializeRoad: initializeRoad,
          animateRoad: animateRoad
        }
      }());

      Burnout.menu = (function(){
        //location.reload();
      }());

      Burnout.player = (function() {

        var playerCar01 = '.player01',
            playerScale = 0.15,
            playerPositionX = 0,
            playerPositionY = 0;

        function initializePlayer() {
            //$('body').append('<div class="player01"></div>');
            log("scale Factor : " + scaleFactor());
            log($('.road01').height());
            log(imageScaleFactor($(playerCar01).width()));
            $(playerCar01).css("transform",
                               "scale("+(imageScaleFactor($(playerCar01).width()) *
                                playerScale)+")");
        };

        function updatePlayer(event) {
          //$('.playerCar1').append('<div>');
          //console.info("sdfd");
          //var newXPosition = $(".playerCar1").position().left + 100;
          //$(".playerCar1").css("left:", newXPosition + "px");
          log("log is working!");
          //var newXPosition = $(playerCar01).position();
          //$(".player01").moveTo(90);
          //$(".player01").speed(0.5);
          //log(newXPosition);
          //$(playerCar01).css("left", newXPosition + "px"); // we add "px" to say our value is in pixels.
          //$(playerCar01).css("transform", "scale("+scaleFactor()+")");
          //$(".playerCar1").moveTo(0);
          //$(".playerCar1").css("top", "100px");
          //d = $(".playerCar1").css("z-index");
          //log(d);
          //$(".playerCar1").css("z-index", 5);
        };

        return {
          initializePlayer: initializePlayer,
          updatePlayer: updatePlayer
        }
      }());

      /* initialize game
         1. initialize Players Car
      */
      function initialize() {
        Burnout.road.initializeRoad();
        Burnout.player.initializePlayer();
      }

      function scaleFactor() {
        if (windowWidth > windowHeight) {
          // landscape calculation
          return windowHeight / 512;
          return
        } else {
          // portrait calculation
          return windowWidth / 512;
        }
      }

      function imageScaleFactor(width) {
        return (512 / width * scaleFactor());
      }

      /* How do i build a game loop?
         level duration
      */
      function startGameLoop() {
        Burnout.road.animateRoad();
        if (!paused) {
          setTimeout(startGameLoop, 200);
        }
      }

      /* Entry point of the Application
         It is used to:
         1. startGameLoop
         2. addEventHandlers
      */
      $(document).ready(function() {
        initialize();
        startGameLoop();
          //$(".player01").moveTo(50);

        $("body").onTap(function(event) {
          Burnout.player.updatePlayer(event);
         });

         $("#menu").onTap(function(e) {
            var modal = document.getElementById('myModal');
            modal.style.display = "block";
            paused = true;
            log("pause game :" + paused);
         });

         $(".close").onTap(function(){
           var span = document.getElementsByClassName("close")[0];
           var modal = document.getElementById('myModal');
           modal.style.display = "none";
           paused = false;
           startGameLoop();
         });

         $(window).resize(function(event) {
           windowWidth = $(window).width();
           windowHeight = $(window).height();
         });
      });

   </script>

   <style type="text/css">

    .player01 {
      background-image: url('./images/cars_mini.png');
      background-size: auto;
      transform-origin: 0px 0px;
      width: 203px;
      height: 338px;
      position: absolute;
      z-index: 5;
    }

    body {
      position: relative;
      background-color: black;
    }

    #sid {
      font-family: 'Lobster', cursive;
      font-size: 30;
      color: white;
      top: 10px;
      left: 350px;
      position: fixed;
      z-index: 5;
    }

    #menu {
      font-family: 'Lobster', cursive;
      font-size: 30;
      color: white;
      top: 10px;
      left: 50px;
      position: fixed;
      z-index: 5;
    }

    .road01 {
      background-image: url('./images/tunnel_road01.png');
      background-size: auto;
      width: 512px;
      height: 512px;
      position: absolute;
      transform-origin: 0px 0px;
      z-index: -10;
    }

    .road02 {
      background-image: url('./images/tunnel_road02.png');
      background-size: auto;
      width: 512px;
      height: 512px;
      position: absolute;
      transform-origin: 0px 0px;
      z-index: -10;
      }

      /* The Modal (background) */
    .modal {
        display: none; /* Hidden by default */
        position: fixed; /* Stay in place */
        z-index: 1; /* Sit on top */
        left: 0;
        top: 0;
        width: 100%; /* Full width */
        height: 100%; /* Full height */
        overflow: auto; /* Enable scroll if needed */
        background-color: rgb(0,0,0); /* Fallback color */
        background-color: rgba(0,0,0,0.4); /* Black w/ opacity */
        z-index: 10;
    }

    /* Modal Content/Box */
    .modal-content {
        background-color: #fefefe;
        margin: 15% auto; /* 15% from the top and centered */
        padding: 20px;
        border: 1px solid #888;
        width: 80%; /* Could be more or less, depending on screen size */
        z-index: 10;
    }

    /* The Close Button */
    .close {
        color: #aaa;
        float: right;
        font-size: 28px;
        font-weight: bold;
    }

    .close:hover,
    .close:focus {
        color: black;
        text-decoration: none;
        cursor: pointer;
    }

    .modal-header {
    padding: 2px 16px;
    background-color: #5cb85c;
    color: white;
}

/* Modal Body */
.modal-body {padding: 2px 16px;}

/* Modal Footer */
.modal-footer {
    padding: 2px 16px;
    background-color: #5cb85c;
    color: white;
}

/* Modal Content */
.modal-content {
    position: relative;
    background-color: #fefefe;
    margin: auto;
    padding: 0;
    border: 1px solid #888;
    width: 80%;
    box-shadow: 0 4px 8px 0 rgba(0,0,0,0.2),0 6px 20px 0 rgba(0,0,0,0.19);
    -webkit-animation-name: animatetop;
    -webkit-animation-duration: 0.4s;
    animation-name: animatetop;
    animation-duration: 0.4s
}

/* Add Animation */
@-webkit-keyframes animatetop {
    from {top: -300px; opacity: 0}
    to {top: 0; opacity: 1}
}

@keyframes animatetop {
    from {top: -300px; opacity: 0}
    to {top: 0; opacity: 1}
}

   </style>
</head>
<body>
  <div class="road01"></div>
  <div class="road02"></div>
  <div id="menu">menu</div>
  <div id="sid">SID: 1234</div>
  <div class="player01"></div>

  <div id="myModal" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <span class="close">&times;</span>
        <h2>Modal Header</h2>
      </div>
      <div class="modal-body">
        <p>Some text in the Modal Body</p>
        <p>Some other text...</p>
      </div>
    </div>
  </body>
</html>
